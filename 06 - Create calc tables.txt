Option Compare Database

' ===== Creating tables and seeting columns for each quarter's calculation. =====



Public Sub calc_tables()

    DoCmd.SetWarnings False
    

        Dim strSQL As String
        
        sqlrun = "CREATE TABLE CALCULATION_Q1 (Root TEXT, Asset_value FLOAT, Ass_val_excl_cash FLOAT, BPPA_IM FLOAT, BPPA_SC FLOAT, IM_FEE FLOAT, IM_VAT_FEE FLOAT, IM_SC_FEE FLOAT, TOTAL_FEE FLOAT, ACTUAL_IM_FEE FLOAT, ACTUAL_IM_VAT_FEE FLOAT, ACTUAL_SC_FEE FLOAT, ACTUAL_TOTAL_FEE FLOAT, IM_FEE_DIFFERENCE FLOAT, IM_VAT_FEE_DIFFERENCE FLOAT, SC_FEE_DIFFERENCE FLOAT, TOTAL_FEE_DIFFERENCE FLOAT );"
        DoCmd.RunSQL (sqlrun)

        sqlrun = "CREATE TABLE CALCULATION_Q2 (Root TEXT, Asset_value FLOAT, Ass_val_excl_cash FLOAT, BPPA_IM FLOAT, BPPA_SC FLOAT, IM_FEE FLOAT, IM_VAT_FEE FLOAT, IM_SC_FEE FLOAT, TOTAL_FEE FLOAT, ACTUAL_IM_FEE FLOAT, ACTUAL_IM_VAT_FEE FLOAT, ACTUAL_SC_FEE FLOAT, ACTUAL_TOTAL_FEE FLOAT, IM_FEE_DIFFERENCE FLOAT, IM_VAT_FEE_DIFFERENCE FLOAT, SC_FEE_DIFFERENCE FLOAT, TOTAL_FEE_DIFFERENCE FLOAT );"
        DoCmd.RunSQL (sqlrun)
        
        sqlrun = "CREATE TABLE CALCULATION_Q3 (Root TEXT, Asset_value FLOAT, Ass_val_excl_cash FLOAT, BPPA_IM FLOAT, BPPA_SC FLOAT, IM_FEE FLOAT, IM_VAT_FEE FLOAT, IM_SC_FEE FLOAT, TOTAL_FEE FLOAT, ACTUAL_IM_FEE FLOAT, ACTUAL_IM_VAT_FEE FLOAT, ACTUAL_SC_FEE FLOAT, ACTUAL_TOTAL_FEE FLOAT, IM_FEE_DIFFERENCE FLOAT, IM_VAT_FEE_DIFFERENCE FLOAT, SC_FEE_DIFFERENCE FLOAT, TOTAL_FEE_DIFFERENCE FLOAT );"
        DoCmd.RunSQL (sqlrun)

'        ' Don't currently need quarter 4 table.
'        sqlrun = "CREATE TABLE CALCULATION_Q4 (Root TEXT, Asset_value FLOAT, Ass_val_excl_cash FLOAT, BPPA_IM FLOAT, BPPA_SC FLOAT, IM_FEE FLOAT, IM_VAT_FEE FLOAT, IM_SC_FEE FLOAT, TOTAL_FEE FLOAT, ACTUAL_IM_FEE FLOAT, ACTUAL_IM_VAT_FEE FLOAT, ACTUAL_SC_FEE FLOAT, ACTUAL_TOTAL_FEE FLOAT, IM_FEE_DIFFERENCE FLOAT, IM_VAT_FEE_DIFFERENCE FLOAT, SC_FEE_DIFFERENCE FLOAT, TOTAL_FEE_DIFFERENCE FLOAT );"
'        DoCmd.RunSQL (sqlrun)
        
        
    DoCmd.SetWarnings True
    
End Sub

